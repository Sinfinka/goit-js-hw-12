{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('.input');\nconst gallery = document.getElementById('gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more-btn');\nconst paginationInfo = document.getElementById('pagination-info');\nconst perPage = 200;\n\nconst apiKey = '41719954-f83183d98e199e8ea762c32d5';\nlet currentPage = 1;\nlet searchTerm = '';\nlet isToastDisplayed = false;\n\nfunction showLoadMoreButton(totalHits) {\n  const totalPages = Math.ceil(totalHits / perPage);\n  const hasChildren = gallery.children.length > 0;\n  const isLastPage = totalPages <= currentPage;\n\n  if (hasChildren && !isLastPage) {\n    loadMoreButton.classList.remove('not-visible');\n    loadMoreButton.classList.add('visible');\n  } else {\n    console.log('btn');\n    loadMoreButton.classList.remove('visible');\n    loadMoreButton.classList.add('not-visible');\n  }\n}\n\nfunction showErrorToastNoImages() {\n  if (!isToastDisplayed) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n      timeout: 3500,\n      progressBar: false,\n    });\n    isToastDisplayed = true;\n  }\n}\n\nfunction showCautionToastRechedTheEnd() {\n  if (!isToastDisplayed) {\n    iziToast.warning({\n      title: 'Caution',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n      timeout: 3500,\n      progressBar: false,\n      color: 'blue',\n    });\n    isToastDisplayed = true;\n  }\n}\n\nfunction showPaginationInfo(totalHits) {\n  const totalPages = Math.ceil(totalHits / perPage);\n  paginationInfo.textContent = `Page ${currentPage} of ${totalPages}`;\n\n  if (parseInt(totalPages, 10) <= parseInt(currentPage, 10)) {\n    showLoadMoreButton(totalHits);\n    showCautionToastRechedTheEnd();\n  }\n}\n\nform.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  const newSearchTerm = searchInput.value.trim();\n\n  if (!newSearchTerm) {\n    return;\n  }\n\n  loader.classList.remove('hide');\n  if (newSearchTerm !== searchTerm) {\n    gallery.innerHTML = '';\n    searchTerm = newSearchTerm;\n    currentPage = 1;\n  }\n\n  try {\n    const response = await fetchImages();\n    const images = response.data.hits;\n\n    if (images.length > 0) {\n      displayImages(images);\n      showPaginationInfo(response.data.totalHits);\n      showLoadMoreButton(response.data.totalHits);\n    } else {\n      showErrorToastNoImages();\n    }\n  } catch (error) {\n    console.error('Error fetching data:', error);\n  } finally {\n    loader.classList.add('hide');\n  }\n});\n\nloadMoreButton.addEventListener('click', async function () {\n  loader.classList.remove('hide');\n  currentPage++;\n\n  try {\n    const response = await fetchImages();\n    const images = response.data.hits;\n\n    if (images.length > 0) {\n      displayImages(images);\n      showPaginationInfo(response.data.totalHits);\n\n      const cardHeight = gallery.firstElementChild.clientHeight;\n\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    } else {\n      showErrorToastNoImages();\n    }\n  } catch (error) {\n    console.error('Error fetching more data:', error);\n    showErrorToastNoImages();\n  } finally {\n    loader.classList.add('hide');\n    showLoadMoreButton(response.data.totalHits);\n  }\n});\n\nasync function fetchImages() {\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n    searchTerm\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${perPage}`;\n\n  try {\n    loader.classList.remove('hide');\n\n    const response = await axios.get(apiUrl);\n    const images = response.data.hits;\n\n    if (images.length > 0) {\n      displayImages(images);\n      showPaginationInfo(response.data.totalHits);\n      showLoadMoreButton(response.data.totalHits);\n    } else {\n      showErrorToastNoImages();\n    }\n\n    return response;\n  } catch (error) {\n    console.error('Error fetching data:', error);\n    showErrorToastNoImages();\n    throw error;\n  } finally {\n    loader.classList.add('hide');\n  }\n}\n\nfunction displayImages(images) {\n  const fragment = document.createDocumentFragment();\n\n  images.forEach(image => {\n    const li = document.createElement('li');\n    li.classList.add('gallery-item');\n\n    const a = document.createElement('a');\n    a.href = image.largeImageURL;\n    a.title = image.tags;\n\n    const img = document.createElement('img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n\n    const descContainer = document.createElement('div');\n    descContainer.classList.add('image-desc');\n\n    const descItems = [\n      { label: 'Likes', value: image.likes },\n      { label: 'Views', value: image.views },\n      { label: 'Comments', value: image.comments },\n      { label: 'Downloads', value: image.downloads },\n    ];\n\n    descItems.forEach(item => {\n      const descItem = document.createElement('div');\n      descItem.classList.add('image-desc-item');\n\n      const label = document.createElement('div');\n      label.classList.add('image-desc-label');\n      label.textContent = item.label;\n\n      const value = document.createElement('div');\n      value.textContent = item.value;\n\n      descItem.appendChild(label);\n      descItem.appendChild(value);\n      descContainer.appendChild(descItem);\n    });\n\n    a.appendChild(img);\n    li.appendChild(a);\n    li.appendChild(descContainer);\n    fragment.appendChild(li);\n  });\n\n  gallery.appendChild(fragment);\n\n  const lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n}\n"],"names":["form","searchInput","gallery","loader","loadMoreButton","paginationInfo","perPage","apiKey","currentPage","searchTerm","isToastDisplayed","showLoadMoreButton","totalHits","totalPages","hasChildren","isLastPage","showErrorToastNoImages","iziToast","showCautionToastRechedTheEnd","showPaginationInfo","event","newSearchTerm","response","fetchImages","images","displayImages","error","cardHeight","apiUrl","axios","fragment","image","li","img","descContainer","item","descItem","label","value","SimpleLightbox"],"mappings":"+vBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAc,SAAS,cAAc,QAAQ,EAC7CC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,gBAAgB,EACxDC,EAAiB,SAAS,eAAe,iBAAiB,EAC1DC,EAAU,IAEVC,EAAS,qCACf,IAAIC,EAAc,EACdC,EAAa,GACbC,EAAmB,GAEvB,SAASC,EAAmBC,EAAW,CACrC,MAAMC,EAAa,KAAK,KAAKD,EAAYN,CAAO,EAC1CQ,EAAcZ,EAAQ,SAAS,OAAS,EACxCa,EAAaF,GAAcL,EAE7BM,GAAe,CAACC,GAClBX,EAAe,UAAU,OAAO,aAAa,EAC7CA,EAAe,UAAU,IAAI,SAAS,IAEtC,QAAQ,IAAI,KAAK,EACjBA,EAAe,UAAU,OAAO,SAAS,EACzCA,EAAe,UAAU,IAAI,aAAa,EAE9C,CAEA,SAASY,GAAyB,CAC3BN,IACHO,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,WACV,QAAS,KACT,YAAa,EACnB,CAAK,EACDP,EAAmB,GAEvB,CAEA,SAASQ,GAA+B,CACjCR,IACHO,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,6DACT,SAAU,WACV,QAAS,KACT,YAAa,GACb,MAAO,MACb,CAAK,EACDP,EAAmB,GAEvB,CAEA,SAASS,EAAmBP,EAAW,CACrC,MAAMC,EAAa,KAAK,KAAKD,EAAYN,CAAO,EAChDD,EAAe,YAAc,QAAQG,QAAkBK,IAEnD,SAASA,EAAY,EAAE,GAAK,SAASL,EAAa,EAAE,IACtDG,EAAmBC,CAAS,EAC5BM,IAEJ,CAEAlB,EAAK,iBAAiB,SAAU,eAAgBoB,EAAO,CACrDA,EAAM,eAAc,EACpB,MAAMC,EAAgBpB,EAAY,MAAM,KAAI,EAE5C,GAAKoB,EAIL,CAAAlB,EAAO,UAAU,OAAO,MAAM,EAC1BkB,IAAkBZ,IACpBP,EAAQ,UAAY,GACpBO,EAAaY,EACbb,EAAc,GAGhB,GAAI,CACF,MAAMc,EAAW,MAAMC,IACjBC,EAASF,EAAS,KAAK,KAEzBE,EAAO,OAAS,GAClBC,EAAcD,CAAM,EACpBL,EAAmBG,EAAS,KAAK,SAAS,EAC1CX,EAAmBW,EAAS,KAAK,SAAS,GAE1CN,GAEH,OAAQU,EAAP,CACA,QAAQ,MAAM,uBAAwBA,CAAK,CAC/C,QAAY,CACRvB,EAAO,UAAU,IAAI,MAAM,CAC5B,EACH,CAAC,EAEDC,EAAe,iBAAiB,QAAS,gBAAkB,CACzDD,EAAO,UAAU,OAAO,MAAM,EAC9BK,IAEA,GAAI,CACF,MAAMc,EAAW,MAAMC,IACjBC,EAASF,EAAS,KAAK,KAE7B,GAAIE,EAAO,OAAS,EAAG,CACrBC,EAAcD,CAAM,EACpBL,EAAmBG,EAAS,KAAK,SAAS,EAE1C,MAAMK,EAAazB,EAAQ,kBAAkB,aAE7C,OAAO,SAAS,CACd,IAAKyB,EAAa,EAClB,SAAU,QAClB,CAAO,CACP,MACMX,GAEH,OAAQU,EAAP,CACA,QAAQ,MAAM,4BAA6BA,CAAK,EAChDV,GACJ,QAAY,CACRb,EAAO,UAAU,IAAI,MAAM,EAC3BQ,EAAmB,SAAS,KAAK,SAAS,CAC3C,CACH,CAAC,EAED,eAAeY,GAAc,CAC3B,MAAMK,EAAS,gCAAgCrB,OAAY,mBACzDE,CACD,kEAAiED,cAAwBF,IAE1F,GAAI,CACFH,EAAO,UAAU,OAAO,MAAM,EAE9B,MAAMmB,EAAW,MAAMO,EAAM,IAAID,CAAM,EACjCJ,EAASF,EAAS,KAAK,KAE7B,OAAIE,EAAO,OAAS,GAClBC,EAAcD,CAAM,EACpBL,EAAmBG,EAAS,KAAK,SAAS,EAC1CX,EAAmBW,EAAS,KAAK,SAAS,GAE1CN,IAGKM,CACR,OAAQI,EAAP,CACA,cAAQ,MAAM,uBAAwBA,CAAK,EAC3CV,IACMU,CACV,QAAY,CACRvB,EAAO,UAAU,IAAI,MAAM,CAC5B,CACH,CAEA,SAASsB,EAAcD,EAAQ,CAC7B,MAAMM,EAAW,SAAS,yBAE1BN,EAAO,QAAQO,GAAS,CACtB,MAAMC,EAAK,SAAS,cAAc,IAAI,EACtCA,EAAG,UAAU,IAAI,cAAc,EAE/B,MAAM,EAAI,SAAS,cAAc,GAAG,EACpC,EAAE,KAAOD,EAAM,cACf,EAAE,MAAQA,EAAM,KAEhB,MAAME,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,IAAMF,EAAM,aAChBE,EAAI,IAAMF,EAAM,KAEhB,MAAMG,EAAgB,SAAS,cAAc,KAAK,EAClDA,EAAc,UAAU,IAAI,YAAY,EAEtB,CAChB,CAAE,MAAO,QAAS,MAAOH,EAAM,KAAO,EACtC,CAAE,MAAO,QAAS,MAAOA,EAAM,KAAO,EACtC,CAAE,MAAO,WAAY,MAAOA,EAAM,QAAU,EAC5C,CAAE,MAAO,YAAa,MAAOA,EAAM,SAAW,CACpD,EAEc,QAAQI,GAAQ,CACxB,MAAMC,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,UAAU,IAAI,iBAAiB,EAExC,MAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAU,IAAI,kBAAkB,EACtCA,EAAM,YAAcF,EAAK,MAEzB,MAAMG,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,YAAcH,EAAK,MAEzBC,EAAS,YAAYC,CAAK,EAC1BD,EAAS,YAAYE,CAAK,EAC1BJ,EAAc,YAAYE,CAAQ,CACxC,CAAK,EAED,EAAE,YAAYH,CAAG,EACjBD,EAAG,YAAY,CAAC,EAChBA,EAAG,YAAYE,CAAa,EAC5BJ,EAAS,YAAYE,CAAE,CAC3B,CAAG,EAED9B,EAAQ,YAAY4B,CAAQ,EAEX,IAAIS,EAAe,YAAY,EACvC,QAAO,CAClB"}